{
  "my-pipeline": {
    "processors": [
      {
        "grok": {
          "field": "message",
          "patterns": [
            "%{MYTIME:time}? %{LEVEL:log.level}? %{MYMSG:msg}? %{MYAPP:app}?"
          ],
          "pattern_definitions": {
            "LEVEL": "level=(?<level>[^ ]*)",
            "MYMSG": "msg=\"(?<msg>.*)\"",
            "MYAPP": "application=(?<app>[^ ]*)",
            "MYTIME": "time=(?<time>[^ ]*)"
          }
        }
      },
      {
        "date": {
          "field": "@timestamp",
          "formats": [
            "dd/MMM/yyyy:HH:mm:ss Z",
            "ISO8601"
          ]
        }
      },
      {
        "geoip": {
          "field": "source.ip",
          "target_field": "source.geo",
          "ignore_failure": true
        }
      },
      {
        "user_agent": {
          "field": "user_agent",
          "ignore_failure": true
        }
      },
      {
        "set": {
          "field": "log.level",
          "copy_from": "level"
        }
      }
    ]
  }
}