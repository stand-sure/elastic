{
  "my-pipeline": {
    "processors": [
      {
        "grok": {
          "field": "message",
          "pattern_definitions": {
            "LEVEL": "level=(?<level>[^ ]*)",
            "MYMSG": "msg=\"(?<msg>.*)\"",
            "MYAPP": "application=(?<app>[^ ]*)",
            "MYTIME": "time=(?<time>[^ ]*)"
          },
          "patterns": [
            "%{MYTIME:time}? %{LEVEL:level}? %{MYMSG:msg}? %{MYAPP:app}?"
          ]
        }
      },
      {
        "date": {
          "field": "@timestamp",
          "formats": ["dd/MMM/yyyy:HH:mm:ss Z", "ISO8601"]
        }
      },
      {
        "geoip": {
          "field": "source.ip",
          "target_field": "source.geo",
          "ignore_failure": true
        }
      },
      { "user_agent": { "field": "user_agent", "ignore_failure": true } }
    ]
  }
}
